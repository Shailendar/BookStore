@model IEnumerable<BookStore.DA.Order>
@{
    ViewBag.Title = "My Orders";
    int serialNumber = 1;
}
@if (User != null && User.Identity.IsAuthenticated == true)
{
    var currentUser = ((BookStore.Models.CustomPrincipal)(User));

    if (currentUser.Role.ToUpper().Equals("ADMIN"))
    {
        <h2>Customer Orders</h2>
        <br />
        using (Html.BeginForm())
        {
            <p>
                @Html.TextBox("searchString", "", new { style = "width:260px; height:35px;border-radius:5px; border-style:solid;" })
                <button type="submit" class="btn btn-default">Search</button>
            </p>
        }
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th style="width: 5%; text-align: center;">S.No</th>
                    <th style="width: 3%; text-align: center;">Order Id</th>
                    <th style="width: 5%; text-align: center;">Customer Name</th>
                    <th style="width: 3%; text-align: center;">Order Date</th>
                    <th style="width: 7%; text-align: center;">Payment Type</th>
                    <th style="width: 5%; text-align: center;">Shipping Address</th>
                    <th style="width: 5%; text-align: center;">Total Price</th>
                    <th style="width: 1%; text-align: center;">Total Discount</th>
                    <th style="width: 3%; text-align: center;">Total ShippingCost</th>
                    <th style="width: 2%; text-align: center;">Grand Total</th>
                    <th style="width: 10%; text-align: center;">Status</th>
                    <th style="width: 1%; text-align: center;">Edit</th>
                </tr>
            </thead>
            <tbody>

                @foreach (var item in Model)
                {
                    <tr>
                        <td style="text-align: center;">@serialNumber</td>
                        <td style="text-align: center;">
                            @Html.ActionLink(item.Id.ToString(), "OrderItems", "OrderItems", new { orderId = item.Id }, null)
                        </td>
                        <td style="text-align: center;">@item.Customer.FirstName</td>
                        <td style="text-align: center;">@item.OrderDate</td>
                        <td style="text-align: center;">@item.PaymentType.Type</td>
                        <td style="text-align: center;">
                            @item.ShippingAddress.Street1,@item.ShippingAddress.Street2,@item.ShippingAddress.Landmark,
                            @item.ShippingAddress.City,@item.ShippingAddress.State,@item.ShippingAddress.State,@item.ShippingAddress.Zipcode,@item.ShippingAddress.Mobile
                        </td>
                        <td style="text-align: center;">@item.TotalPrice</td>
                        <td style="text-align: center;">@item.TotalDiscount</td>
                        <td style="text-align: center;">@item.TotalShippingCost</td>
                        <td style="text-align: center;">@item.GrandTotal</td>
                        <td style="text-align: center;">@item.OrderStatus.Code</td>
                        <td style="text-align: center;">
                            @Html.ActionLink("Edit Status", "Edit", new { orderId = item.Id }, new { @class = "btn btn-primary btn-sm" })
                        </td>
                    </tr>
                    serialNumber = serialNumber + 1;
                }
            </tbody>
        </table>
    }

    else if (currentUser.Role.ToUpper().Equals("CUSTOMER"))
    {
        <h2>My Orders</h2>
        <div class="jumbotron" style="width:1230px;">
            <div class="panel panel-default">
                <table style="background-color:white" class="table table-bordered">
                    <thead>
                        <tr>
                            <th style="width: 5%; text-align: center;">S.No</th>
                            <th style="width: 3%; text-align: center;">Order Id</th>
                            <th style="width: 5%; text-align: center;">Customer Name</th>
                            <th style="width: 3%; text-align: center;">Order Date</th>
                            <th style="width: 7%; text-align: center;">Payment Type</th>
                            <th style="width: 5%; text-align: center;">Shipping Address</th>
                            <th style="width: 2%; text-align: center;">Grand Total</th>
                            <th style="width: 1%; text-align: center;">Status</th>
                            <th style="width:2%; text-align:center;">Cancel Order</th>
                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var item in Model)
                        {
                            <tr>
                                <td style="text-align: center;">@serialNumber</td>
                                <td style="text-align: center;">
                                    @Html.ActionLink(item.Id.ToString(), "OrderItems", "OrderItems", new { orderId = item.Id }, null)
                                </td>
                                <td style="text-align: center;">@item.Customer.FirstName</td>
                                <td style="text-align: center;">@item.OrderDate</td>
                                <td style="text-align: center;">@item.PaymentType.Type</td>
                                <td style="text-align: center;">
                                    @item.ShippingAddress.Street1,@item.ShippingAddress.Street2,@item.ShippingAddress.Landmark,
                                    @item.ShippingAddress.City,@item.ShippingAddress.State,@item.ShippingAddress.State,@item.ShippingAddress.Zipcode,@item.ShippingAddress.Mobile
                                </td>
                                <td style="text-align: center;">@item.GrandTotal</td>
                                <td style="text-align: center;">@item.OrderStatus.Code</td>
                                @if (item.OrderStatus.Id == 1 || item.OrderStatus.Id == 8)
                                {
                                    <td style="text-align: center;">
                                        @Html.ActionLink("Cancel Order", "Cancel", new { orderId = item.Id }, new { @class = "btn btn-primary btn-sm" })
                                    </td>
                                }
                                else
                                {
                                    <td style="text-align: center;">
                                        @*@@Html.ActionLink("Cancel Order", "Cancel", new { orderId = item.Id }, new { @class = "btn btn-primary btn-sm disabled" })*@
                                    </td>
                                }
                            </tr>
                                serialNumber = serialNumber + 1;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
}

